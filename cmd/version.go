package cmd

import (
	"fmt"
	"os"
	"strings"
	"time"

	"github.com/cheggaaa/pb"
	"github.com/rs/zerolog/log"
	"github.com/spf13/cobra"
	"github.com/y4ney/collect-cnnvd-vuln/internal/cnnvd"
	"github.com/y4ney/collect-cnnvd-vuln/internal/config"
	"golang.org/x/text/encoding/simplifiedchinese"
)

// versionCmd represents the version command
var versionCmd = &cobra.Command{
	Use:   "version",
	Short: "打印 collect-cnnvd-vuln 的版本",
	Long:  `所有的软件导游版本，collect-cnnvd-vuln也不例外`,
	RunE:  runPrintVersion,
}

func runPrintVersion(_ *cobra.Command, _ []string) error {
	fmt.Fprintf(out, "%s version %s\n", config.AppName, config.AppVersion)
	fmt.Fprintf(out, "build date: %s\n", config.BuildTime)
	fmt.Fprintf(out, "commit: %s\n\n", config.LastCommitHash)
	fmt.Fprintln(out, "https://github.com/y4ney/collect-cnnvd-vuln")
	// iOS
	// var codes []string = []string{"CNNVD-202203-1346", "CNNVD-202207-2075", "CNNVD-202207-2014", "CNNVD-202207-2091", "CNNVD-202207-2067", "CNNVD-202207-2059", "CNNVD-202207-2065", "CNNVD-202207-1744", "CNNVD-202207-2069", "CNNVD-202207-2047", "CNNVD-202207-2024", "CNNVD-202207-2017", "CNNVD-202207-2088", "CNNVD-202207-2087", "CNNVD-202207-2093", "CNNVD-202210-378", "CNNVD-202210-1670", "CNNVD-202210-1663", "CNNVD-202210-2351", "CNNVD-202210-2348", "CNNVD-202210-2346", "CNNVD-202210-2349", "CNNVD-202210-2354", "CNNVD-202210-2350", "CNNVD-202210-2347", "CNNVD-202210-2514", "CNNVD-202211-1881", "CNNVD-202211-1876", "CNNVD-202212-3045", "CNNVD-202212-3160", "CNNVD-202212-3048", "CNNVD-202212-3119", "CNNVD-202212-3026", "CNNVD-202212-3035", "CNNVD-202212-3146", "CNNVD-202212-3041", "CNNVD-202212-3175", "CNNVD-202212-3020", "CNNVD-202212-3024", "CNNVD-202212-3028", "CNNVD-202212-3034", "CNNVD-202212-3033", "CNNVD-202212-3232", "CNNVD-202212-3022", "CNNVD-202212-3162", "CNNVD-202212-3105", "CNNVD-202212-3124", "CNNVD-202212-3021", "CNNVD-202212-3115", "CNNVD-202212-3154", "CNNVD-202212-3043", "CNNVD-202212-3029", "CNNVD-202212-3025", "CNNVD-202212-3037", "CNNVD-202212-3036", "CNNVD-202212-3153", "CNNVD-202212-3042", "CNNVD-202212-3023", "CNNVD-202212-3049", "CNNVD-202212-3038", "CNNVD-202212-3120", "CNNVD-202212-3030", "CNNVD-202212-3032", "CNNVD-202212-3047", "CNNVD-202212-3151", "CNNVD-202212-3040", "CNNVD-202212-3031", "CNNVD-202212-3136", "CNNVD-202212-3039", "CNNVD-202212-3027", "CNNVD-202212-3335", "CNNVD-202212-3344", "CNNVD-202212-3334", "CNNVD-202212-3026", "CNNVD-202212-3028", "CNNVD-202212-3047", "CNNVD-202212-3031", "CNNVD-202212-3027", "CNNVD-202007-1775", "CNNVD-202007-1154", "CNNVD-202007-1146", "CNNVD-202108-1965", "CNNVD-202007-1158", "CNNVD-202108-2011", "CNNVD-202108-1975", "CNNVD-202007-1150", "CNNVD-202007-1161", "CNNVD-202007-1138", "CNNVD-202212-3032", "CNNVD-202207-2091", "CNNVD-202207-2069", "CNNVD-202210-2348", "CNNVD-202207-2075", "CNNVD-202207-1744", "CNNVD-202304-665", "CNNVD-202304-662", "CNNVD-202212-3035", "CNNVD-202212-3043", "CNNVD-202212-3045", "CNNVD-202212-3033", "CNNVD-202212-3232", "CNNVD-202212-3022", "CNNVD-202212-3021", "CNNVD-202212-3029", "CNNVD-202212-3023", "CNNVD-202212-3030", "CNNVD-202212-3040", "CNNVD-202212-3041", "CNNVD-202304-660", "CNNVD-202304-663", "CNNVD-202212-3154", "CNNVD-202306-1762", "CNNVD-202306-1763", "CNNVD-201310-575", "CNNVD-201310-573", "CNNVD-201310-574", "CNNVD-202303-2279", "CNNVD-202303-2293", "CNNVD-202303-2405", "CNNVD-202303-2315", "CNNVD-202305-1845", "CNNVD-202303-2386", "CNNVD-202303-2306", "CNNVD-202303-2350", "CNNVD-202303-2277", "CNNVD-202305-1827", "CNNVD-202303-2307", "CNNVD-202303-2387", "CNNVD-202303-2373", "CNNVD-202303-2399", "CNNVD-202303-2309", "CNNVD-202303-2358", "CNNVD-202303-2280", "CNNVD-202303-2328", "CNNVD-202303-2320", "CNNVD-202305-1818", "CNNVD-202303-2312", "CNNVD-202303-2281", "CNNVD-202303-2336", "CNNVD-202303-2344", "CNNVD-202303-2391", "CNNVD-202303-2278", "CNNVD-202305-1821", "CNNVD-202303-2365", "CNNVD-202303-2393", "CNNVD-202305-1856", "CNNVD-202305-529", "CNNVD-202303-2313", "CNNVD-202303-2314", "CNNVD-202303-2380", "CNNVD-202307-1894", "CNNVD-202212-3020", "CNNVD-202212-3049", "CNNVD-202212-3334", "CNNVD-202108-2098", "CNNVD-202210-2349", "CNNVD-202212-3136", "CNNVD-202108-2086", "CNNVD-202203-1346", "CNNVD-202108-2047", "CNNVD-202108-2068", "CNNVD-202108-2013", "CNNVD-202305-1842", "CNNVD-202308-1303", "CNNVD-202308-1300", "CNNVD-202308-1293", "CNNVD-202308-1287", "CNNVD-202307-1885", "CNNVD-202309-466", "CNNVD-202309-780", "CNNVD-202307-678"}
	// Android
	// var codes []string = []string{"CNNVD-202201-107", "CNNVD-202201-145", "CNNVD-202201-109", "CNNVD-202201-142", "CNNVD-202201-139", "CNNVD-202201-149", "CNNVD-202201-111", "CNNVD-202201-1334", "CNNVD-202202-483", "CNNVD-202202-475", "CNNVD-202202-491", "CNNVD-202202-479", "CNNVD-202202-487", "CNNVD-202202-1079", "CNNVD-202202-1081", "CNNVD-202202-1067", "CNNVD-202203-571", "CNNVD-202203-583", "CNNVD-202203-572", "CNNVD-202203-526", "CNNVD-202203-570", "CNNVD-202203-564", "CNNVD-202203-569", "CNNVD-202203-531", "CNNVD-202203-589", "CNNVD-202203-553", "CNNVD-202203-538", "CNNVD-202203-525", "CNNVD-202203-585", "CNNVD-202203-2568", "CNNVD-202203-2577", "CNNVD-202203-2575", "CNNVD-202203-2560", "CNNVD-202203-2571", "CNNVD-202203-2576", "CNNVD-202203-2561", "CNNVD-202203-2582", "CNNVD-202203-2549", "CNNVD-202203-2547", "CNNVD-202203-2583", "CNNVD-202203-2586", "CNNVD-202203-2585", "CNNVD-202203-2578", "CNNVD-202204-2486", "CNNVD-202204-2489", "CNNVD-202204-2485", "CNNVD-202204-2491", "CNNVD-202205-1826", "CNNVD-202205-1832", "CNNVD-202205-1819", "CNNVD-202205-1823", "CNNVD-202205-2885", "CNNVD-202206-542", "CNNVD-202206-507", "CNNVD-202206-518", "CNNVD-202206-590", "CNNVD-202206-561", "CNNVD-202206-573", "CNNVD-202206-534", "CNNVD-202206-514", "CNNVD-202206-550", "CNNVD-202206-563", "CNNVD-202206-570", "CNNVD-202206-532", "CNNVD-202206-554", "CNNVD-202206-571", "CNNVD-202206-516", "CNNVD-202206-539", "CNNVD-202206-549", "CNNVD-202206-575", "CNNVD-202206-504", "CNNVD-202206-523", "CNNVD-202206-538", "CNNVD-202207-517", "CNNVD-202207-467", "CNNVD-202207-515", "CNNVD-202207-513", "CNNVD-202207-535", "CNNVD-202207-470", "CNNVD-202207-468", "CNNVD-202207-939", "CNNVD-202208-1923", "CNNVD-202208-1902", "CNNVD-202208-1828", "CNNVD-202208-1829", "CNNVD-202208-1847", "CNNVD-202208-1837", "CNNVD-202208-1834", "CNNVD-202208-2827", "CNNVD-202208-2825", "CNNVD-202208-2818", "CNNVD-202208-2830", "CNNVD-202208-2944", "CNNVD-202208-2897", "CNNVD-202208-2887", "CNNVD-202208-2863", "CNNVD-202208-2894", "CNNVD-202208-2877", "CNNVD-202208-2900", "CNNVD-202208-2937", "CNNVD-202208-2874", "CNNVD-202208-2941", "CNNVD-202208-2875", "CNNVD-202208-2889", "CNNVD-202208-2933", "CNNVD-202208-2890", "CNNVD-202208-2936", "CNNVD-202208-2895", "CNNVD-202208-2868", "CNNVD-202208-2915", "CNNVD-202208-2872", "CNNVD-202208-2939", "CNNVD-202208-2873", "CNNVD-202208-2943", "CNNVD-202209-380", "CNNVD-202209-228", "CNNVD-202209-239", "CNNVD-202209-237", "CNNVD-202209-256", "CNNVD-202209-295", "CNNVD-202209-353", "CNNVD-202209-250", "CNNVD-202209-229", "CNNVD-202210-601", "CNNVD-202211-2158", "CNNVD-202211-2145", "CNNVD-202211-2225", "CNNVD-202211-2201", "CNNVD-202211-2165", "CNNVD-202211-2157", "CNNVD-202211-2146", "CNNVD-202211-2168", "CNNVD-202211-3038", "CNNVD-202301-225", "CNNVD-202301-221", "CNNVD-202301-218", "CNNVD-202301-193", "CNNVD-202301-295", "CNNVD-202301-205", "CNNVD-202301-195", "CNNVD-202301-258", "CNNVD-202301-203", "CNNVD-202301-185", "CNNVD-202301-214", "CNNVD-202301-210", "CNNVD-202301-179", "CNNVD-202006-158", "CNNVD-202302-2323", "CNNVD-202302-2330", "CNNVD-202302-2328", "CNNVD-202303-410", "CNNVD-202303-409", "CNNVD-202303-422", "CNNVD-202303-421", "CNNVD-202303-437", "CNNVD-202303-423", "CNNVD-202303-498", "CNNVD-202303-513", "CNNVD-202303-408", "CNNVD-202303-481", "CNNVD-202303-494", "CNNVD-202303-501", "CNNVD-202301-169", "CNNVD-202301-178", "CNNVD-202301-180", "CNNVD-202304-1644", "CNNVD-202304-1639", "CNNVD-202304-1642", "CNNVD-202304-1668", "CNNVD-202304-1670", "CNNVD-202304-1675", "CNNVD-202304-1657", "CNNVD-202304-1679", "CNNVD-202304-1672", "CNNVD-202304-1645", "CNNVD-202305-1481", "CNNVD-202305-1485", "CNNVD-202305-1478", "CNNVD-202012-544", "CNNVD-202306-1229", "CNNVD-202306-1239", "CNNVD-202306-1267", "CNNVD-202306-1237", "CNNVD-202306-1270", "CNNVD-202306-1235", "CNNVD-202306-1226", "CNNVD-202306-1244", "CNNVD-202303-472", "CNNVD-202307-316", "CNNVD-202307-403", "CNNVD-202307-387", "CNNVD-202307-397", "CNNVD-202307-400", "CNNVD-202208-2888", "CNNVD-202208-2886", "CNNVD-202207-517", "CNNVD-202208-2946", "CNNVD-202206-545", "CNNVD-202208-2904", "CNNVD-202208-2877", "CNNVD-202208-2942", "CNNVD-202112-294", "CNNVD-202208-2882", "CNNVD-202208-2937", "CNNVD-202208-2874", "CNNVD-202208-2884", "CNNVD-202108-1629", "CNNVD-202201-177", "CNNVD-202208-2909", "CNNVD-202208-2878", "CNNVD-202206-526", "CNNVD-202205-1839", "CNNVD-202208-2933", "CNNVD-202209-242", "CNNVD-202208-2890", "CNNVD-202111-233", "CNNVD-202206-583", "CNNVD-202204-2480", "CNNVD-202208-2948", "CNNVD-202208-2923", "CNNVD-202201-1334", "CNNVD-202206-575", "CNNVD-202208-2910", "CNNVD-202211-2183", "CNNVD-202208-2913", "CNNVD-202103-163", "CNNVD-202203-585", "CNNVD-202203-556", "CNNVD-202308-1266", "CNNVD-202308-1283", "CNNVD-202308-1267", "CNNVD-202308-1273", "CNNVD-202308-1269", "CNNVD-202308-1282", "CNNVD-202308-1235", "CNNVD-202308-1255", "CNNVD-202309-612", "CNNVD-202309-627", "CNNVD-202309-621", "CNNVD-202309-629", "CNNVD-202309-615", "CNNVD-202305-1477"}
	// Harmony
	// var codes []string = []string{"CNNVD-202201-285", "CNNVD-202201-278", "CNNVD-202201-289", "CNNVD-202201-272", "CNNVD-202201-277", "CNNVD-202201-280", "CNNVD-202201-307", "CNNVD-202201-279", "CNNVD-202201-312", "CNNVD-202201-282", "CNNVD-202201-314", "CNNVD-202201-297", "CNNVD-202201-294", "CNNVD-202201-302", "CNNVD-202201-274", "CNNVD-202201-273", "CNNVD-202202-443", "CNNVD-202202-442", "CNNVD-202204-2017", "CNNVD-202204-2023", "CNNVD-202204-2027", "CNNVD-202204-2035", "CNNVD-202204-2020", "CNNVD-202204-2012", "CNNVD-202204-2022", "CNNVD-202204-2034", "CNNVD-202209-159", "CNNVD-202209-158", "CNNVD-202209-193", "CNNVD-202209-164", "CNNVD-202209-219", "CNNVD-202209-161", "CNNVD-202209-199", "CNNVD-202209-178", "CNNVD-202209-187", "CNNVD-202209-201", "CNNVD-202209-202", "CNNVD-202209-194", "CNNVD-202209-175", "CNNVD-202209-212", "CNNVD-202209-170", "CNNVD-202209-217", "CNNVD-202209-206", "CNNVD-202209-173", "CNNVD-202209-179", "CNNVD-202209-196", "CNNVD-202209-205", "CNNVD-202209-213", "CNNVD-202209-168", "CNNVD-202209-185", "CNNVD-202209-181", "CNNVD-202209-184", "CNNVD-202210-147", "CNNVD-202210-167", "CNNVD-202210-176", "CNNVD-202210-150", "CNNVD-202210-148", "CNNVD-202210-168", "CNNVD-202210-159", "CNNVD-202210-157", "CNNVD-202210-163", "CNNVD-202210-170", "CNNVD-202210-165", "CNNVD-202210-181", "CNNVD-202210-166", "CNNVD-202210-177", "CNNVD-202210-183", "CNNVD-202210-149", "CNNVD-202210-171", "CNNVD-202210-152", "CNNVD-202210-179", "CNNVD-202210-172", "CNNVD-202210-185", "CNNVD-202210-169", "CNNVD-202210-173", "CNNVD-202210-153", "CNNVD-202210-160", "CNNVD-202210-151", "CNNVD-202210-154", "CNNVD-202210-184", "CNNVD-202210-146", "CNNVD-202210-156", "CNNVD-202210-155", "CNNVD-202210-175", "CNNVD-202210-158", "CNNVD-202211-2127", "CNNVD-202211-2126", "CNNVD-202211-2132", "CNNVD-202211-2129", "CNNVD-202211-2136", "CNNVD-202211-2124", "CNNVD-202211-2130", "CNNVD-202211-2120", "CNNVD-202211-2131", "CNNVD-202211-2128", "CNNVD-202211-2139", "CNNVD-202211-2121", "CNNVD-202211-2138", "CNNVD-202211-2133", "CNNVD-202211-2125", "CNNVD-202211-2123", "CNNVD-202211-2135", "CNNVD-202211-2122", "CNNVD-202212-2481", "CNNVD-202212-2489", "CNNVD-202212-2526", "CNNVD-202212-2513", "CNNVD-202212-2490", "CNNVD-202212-2491", "CNNVD-202212-2524", "CNNVD-202212-2499", "CNNVD-202212-2497", "CNNVD-202212-2512", "CNNVD-202212-2520", "CNNVD-202212-2514", "CNNVD-202212-2510", "CNNVD-202212-2493", "CNNVD-202212-2495", "CNNVD-202212-2506", "CNNVD-202212-2494", "CNNVD-202212-2501", "CNNVD-202212-2511", "CNNVD-202212-2485", "CNNVD-202212-2502", "CNNVD-202212-2482", "CNNVD-202212-2488", "CNNVD-202212-2486", "CNNVD-202212-2490", "CNNVD-202302-349", "CNNVD-202302-341", "CNNVD-202302-345", "CNNVD-202302-344", "CNNVD-202302-346", "CNNVD-202302-340", "CNNVD-202302-343", "CNNVD-202302-347", "CNNVD-202302-353", "CNNVD-202302-352", "CNNVD-202302-342", "CNNVD-202302-339", "CNNVD-202212-2489", "CNNVD-202303-308", "CNNVD-202303-292", "CNNVD-202303-322", "CNNVD-202303-303", "CNNVD-202303-311", "CNNVD-202303-317", "CNNVD-202303-298", "CNNVD-202303-294", "CNNVD-202303-306", "CNNVD-202303-324", "CNNVD-202303-304", "CNNVD-202303-293", "CNNVD-202303-319", "CNNVD-202303-296", "CNNVD-202303-301", "CNNVD-202303-321", "CNNVD-202304-357", "CNNVD-202304-356", "CNNVD-202304-354", "CNNVD-202304-349", "CNNVD-202304-350", "CNNVD-202304-348", "CNNVD-202304-352", "CNNVD-202305-333", "CNNVD-202305-322", "CNNVD-202305-342", "CNNVD-202305-317", "CNNVD-202305-337", "CNNVD-202305-330", "CNNVD-202305-325", "CNNVD-202305-316", "CNNVD-202305-321", "CNNVD-202305-350", "CNNVD-202305-335", "CNNVD-202305-351", "CNNVD-202305-334", "CNNVD-202306-236", "CNNVD-202306-263", "CNNVD-202306-248", "CNNVD-202306-230", "CNNVD-202306-246", "CNNVD-202306-269", "CNNVD-202306-245", "CNNVD-202306-240", "CNNVD-202306-253", "CNNVD-202306-228", "CNNVD-202306-243", "CNNVD-202306-231", "CNNVD-202306-234", "CNNVD-202306-251", "CNNVD-202306-259", "CNNVD-202306-271", "CNNVD-202306-237", "CNNVD-202201-272", "CNNVD-202201-274", "CNNVD-202201-273", "CNNVD-202307-186", "CNNVD-202307-183", "CNNVD-202307-202", "CNNVD-202307-251", "CNNVD-202307-178", "CNNVD-202307-222", "CNNVD-202307-208", "CNNVD-202307-237", "CNNVD-202307-243", "CNNVD-202307-194", "CNNVD-202307-225", "CNNVD-202307-216", "CNNVD-202307-231", "CNNVD-202307-195", "CNNVD-202306-261", "CNNVD-202307-181", "CNNVD-202307-240", "CNNVD-202307-252", "CNNVD-202307-211", "CNNVD-202307-250", "CNNVD-202307-232", "CNNVD-202307-199", "CNNVD-202307-221", "CNNVD-202307-205", "CNNVD-202307-215", "CNNVD-202307-228", "CNNVD-202307-239", "CNNVD-202307-213", "CNNVD-202307-233", "CNNVD-202307-227", "CNNVD-202111-2130", "CNNVD-202110-2226", "CNNVD-202209-164", "CNNVD-202302-338", "CNNVD-202211-2130", "CNNVD-202211-2120", "CNNVD-202302-350", "CNNVD-202112-213", "CNNVD-202211-2133", "CNNVD-202209-168", "CNNVD-202111-2135", "CNNVD-202302-351", "CNNVD-202302-348", "CNNVD-202111-2133", "CNNVD-202210-155", "CNNVD-202204-2034", "CNNVD-202112-209", "CNNVD-202308-348", "CNNVD-202308-360", "CNNVD-202308-361", "CNNVD-202308-346", "CNNVD-202308-339", "CNNVD-202308-367", "CNNVD-202308-366", "CNNVD-202308-368", "CNNVD-202308-353", "CNNVD-202308-372", "CNNVD-202308-359", "CNNVD-202308-344", "CNNVD-202308-356", "CNNVD-202308-357", "CNNVD-202308-355", "CNNVD-202308-370", "CNNVD-202308-341", "CNNVD-202308-364", "CNNVD-202308-365", "CNNVD-202308-362", "CNNVD-202308-363", "CNNVD-202308-369", "CNNVD-202308-371", "CNNVD-202308-358", "CNNVD-202308-350", "CNNVD-202309-274", "CNNVD-202309-293", "CNNVD-202309-294", "CNNVD-202309-2153", "CNNVD-202309-280", "CNNVD-202309-289", "CNNVD-202309-286", "CNNVD-202309-279", "CNNVD-202309-277", "CNNVD-202309-282", "CNNVD-202309-287", "CNNVD-202309-288", "CNNVD-202309-278", "CNNVD-202309-281", "CNNVD-202309-290", "CNNVD-202309-291", "CNNVD-202309-276", "CNNVD-202309-2432", "CNNVD-202309-284", "CNNVD-202309-2385", "CNNVD-202309-273", "CNNVD-202309-292", "CNNVD-202309-275", "CNNVD-202309-283", "CNNVD-202309-285"}
	// Chrome
	// var codes []string = []string{"CNNVD-202201-130", "CNNVD-202201-124", "CNNVD-202201-118", "CNNVD-202201-126", "CNNVD-202201-1782", "CNNVD-202201-1722", "CNNVD-202201-1707", "CNNVD-202202-038", "CNNVD-202202-018", "CNNVD-202202-014", "CNNVD-202202-1190", "CNNVD-202203-059", "CNNVD-202203-069", "CNNVD-202203-062", "CNNVD-202203-1447", "CNNVD-202203-2466", "CNNVD-202203-2453", "CNNVD-202203-2448", "CNNVD-202204-2927", "CNNVD-202204-4689", "CNNVD-202205-2860", "CNNVD-202205-2855", "CNNVD-202205-4050", "CNNVD-202205-4048", "CNNVD-202205-4064", "CNNVD-202205-4316", "CNNVD-202206-2101", "CNNVD-202207-344", "CNNVD-202207-2072", "CNNVD-202208-2076", "CNNVD-202208-2079", "CNNVD-202208-2086", "CNNVD-202208-4547", "CNNVD-202208-4543", "CNNVD-202208-3307", "CNNVD-202208-4384", "CNNVD-202208-4389", "CNNVD-202208-4433", "CNNVD-202209-1046", "CNNVD-202209-1403", "CNNVD-202209-2775", "CNNVD-202209-2784", "CNNVD-202210-702", "CNNVD-202210-2122", "CNNVD-202211-1872", "CNNVD-202211-2402", "CNNVD-202211-3671", "CNNVD-202211-3670", "CNNVD-202211-3681", "CNNVD-202212-3176", "CNNVD-202301-088", "CNNVD-201302-479", "CNNVD-201912-376", "CNNVD-202302-537", "CNNVD-202302-1782", "CNNVD-202303-536", "CNNVD-202303-542", "CNNVD-202303-540", "CNNVD-202302-1779", "CNNVD-202303-1608", "CNNVD-202304-211", "CNNVD-202303-1603", "CNNVD-202212-3180", "CNNVD-202301-689", "CNNVD-202211-3680", "CNNVD-202301-684", "CNNVD-202211-3670", "CNNVD-202212-3176", "CNNVD-202301-682", "CNNVD-202302-534", "CNNVD-202305-1580", "CNNVD-202305-107", "CNNVD-202305-2573", "CNNVD-202011-167", "CNNVD-202306-1003", "CNNVD-201606-032", "CNNVD-201103-168", "CNNVD-202306-1001", "CNNVD-202209-2774", "CNNVD-202202-019", "CNNVD-202208-4382", "CNNVD-202203-058", "CNNVD-202201-1732", "CNNVD-202208-3306", "CNNVD-202209-2785", "CNNVD-202204-4455", "CNNVD-202208-4397", "CNNVD-202204-4688", "CNNVD-202204-4690", "CNNVD-202307-1622", "CNNVD-202208-4547", "CNNVD-202307-1645", "CNNVD-202208-4553", "CNNVD-202307-2251", "CNNVD-202208-4548", "CNNVD-202208-4541", "CNNVD-202308-1368", "CNNVD-202308-1373", "CNNVD-202308-1369", "CNNVD-202107-1062", "CNNVD-202309-928", "CNNVD-202308-2258", "CNNVD-202309-922"}
	// Firefox
	// var codes []string = []string{"CNNVD-202201-736", "CNNVD-202201-749", "CNNVD-202201-748", "CNNVD-202201-742", "CNNVD-202201-857", "CNNVD-202201-738", "CNNVD-202202-589", "CNNVD-202202-575", "CNNVD-202202-585", "CNNVD-202202-584", "CNNVD-202202-590", "CNNVD-202203-707", "CNNVD-202203-712", "CNNVD-202203-709", "CNNVD-202204-2530", "CNNVD-202204-2418", "CNNVD-202204-2523", "CNNVD-202205-1933", "CNNVD-202205-1934", "CNNVD-202205-1928", "CNNVD-202205-4301", "CNNVD-202205-4290", "CNNVD-202205-4288", "CNNVD-202206-2686", "CNNVD-202206-2758", "CNNVD-202206-2690", "CNNVD-202206-2741", "CNNVD-202206-2685", "CNNVD-202206-2687", "CNNVD-202206-2825", "CNNVD-202207-2407", "CNNVD-202207-2439", "CNNVD-202208-3753", "CNNVD-202208-3740", "CNNVD-202208-3718", "CNNVD-202209-1564", "CNNVD-202209-1627", "CNNVD-202210-1243", "CNNVD-202210-1256", "CNNVD-202211-2849", "CNNVD-202211-2901", "CNNVD-202211-2906", "CNNVD-202211-2826", "CNNVD-202211-2895", "CNNVD-202211-2860", "CNNVD-202212-2994", "CNNVD-202212-3000", "CNNVD-202212-2998", "CNNVD-202212-3742", "CNNVD-202204-2522", "CNNVD-202205-1936", "CNNVD-202204-2530", "CNNVD-202204-2416", "CNNVD-202206-2741", "CNNVD-202206-2682", "CNNVD-202202-577", "CNNVD-202206-2685", "CNNVD-202201-860", "CNNVD-202202-576", "CNNVD-202204-2523", "CNNVD-202209-1627", "CNNVD-202206-2686", "CNNVD-202206-2758", "CNNVD-202201-754", "CNNVD-202205-4290", "CNNVD-202206-2687", "CNNVD-202208-3718", "CNNVD-202205-1933", "CNNVD-202207-2430", "CNNVD-202206-2690", "CNNVD-202205-1932", "CNNVD-202211-2825", "CNNVD-202211-2906", "CNNVD-202212-3742", "CNNVD-202207-2409", "CNNVD-202206-2693", "CNNVD-202205-4286", "CNNVD-202207-2426", "CNNVD-202207-2436", "CNNVD-202211-2849", "CNNVD-201906-726", "CNNVD-201907-477", "CNNVD-201910-1302", "CNNVD-202302-1459", "CNNVD-201907-507", "CNNVD-200908-485", "CNNVD-201204-171", "CNNVD-200904-557", "CNNVD-202212-3008", "CNNVD-202212-3005", "CNNVD-200902-081", "CNNVD-200811-203", "CNNVD-200903-087", "CNNVD-200711-365", "CNNVD-200710-417", "CNNVD-200802-143", "CNNVD-202303-1206", "CNNVD-202303-1207", "CNNVD-202301-1521", "CNNVD-202302-1589", "CNNVD-202301-1522", "CNNVD-202301-1526", "CNNVD-202303-1203", "CNNVD-202302-1585", "CNNVD-202302-1690", "CNNVD-202303-1201", "CNNVD-202306-125", "CNNVD-202305-1109", "CNNVD-202304-1593", "CNNVD-202304-1587", "CNNVD-202303-1208", "CNNVD-202303-1102", "CNNVD-202304-921", "CNNVD-202303-1103", "CNNVD-202304-917", "CNNVD-202304-1588", "CNNVD-202306-598", "CNNVD-202305-1103", "CNNVD-202304-923", "CNNVD-202302-1681", "CNNVD-202305-1495", "CNNVD-202304-1304", "CNNVD-202307-164", "CNNVD-202307-160", "CNNVD-202307-167", "CNNVD-202307-170", "CNNVD-202307-171", "CNNVD-202302-1554", "CNNVD-202308-018", "CNNVD-202201-749", "CNNVD-202211-2900", "CNNVD-202112-546", "CNNVD-202210-1256", "CNNVD-202202-569", "CNNVD-202212-2998", "CNNVD-202205-4301", "CNNVD-202308-025", "CNNVD-202308-005", "CNNVD-202308-015", "CNNVD-201606-287", "CNNVD-201507-110", "CNNVD-202210-1243", "CNNVD-202210-1299", "CNNVD-202308-2372", "CNNVD-202308-2392", "CNNVD-202308-2390", "CNNVD-202308-2385", "CNNVD-202309-2284", "CNNVD-202309-2279", "CNNVD-202309-2276"}
	// Safari
	// var codes []string = []string{"CNNVD-202208-3345", "CNNVD-202209-777", "CNNVD-202209-785", "CNNVD-202209-768", "CNNVD-202209-780", "CNNVD-202209-1602", "CNNVD-202209-1604", "CNNVD-202210-1675", "CNNVD-202105-1578", "CNNVD-202105-1573", "CNNVD-202103-568", "CNNVD-202105-1570", "CNNVD-202105-1574", "CNNVD-202209-1604", "CNNVD-202209-777", "CNNVD-202209-785", "CNNVD-202305-482", "CNNVD-202304-574", "CNNVD-202305-1848", "CNNVD-202307-2205", "CNNVD-202305-1844", "CNNVD-202306-1545", "CNNVD-202307-1953", "CNNVD-202307-1974", "CNNVD-202307-1959", "CNNVD-202307-1972", "CNNVD-202307-1964", "CNNVD-202307-1956", "CNNVD-202307-1965", "CNNVD-202307-2197", "CNNVD-202309-2266", "CNNVD-202309-2063"}
	// Redis
	var codes []string = []string{"CNNVD-202102-1679", "CNNVD-202103-1723", "CNNVD-202105-103", "CNNVD-202105-105", "CNNVD-202107-1615", "CNNVD-202109-1327", "CNNVD-202110-136", "CNNVD-202110-140", "CNNVD-202110-135", "CNNVD-202110-137", "CNNVD-202110-142", "CNNVD-202110-141", "CNNVD-202110-139", "CNNVD-202110-138", "CNNVD-202110-1841", "CNNVD-202111-2170", "CNNVD-202202-1622", "CNNVD-202204-4527", "CNNVD-202204-4526", "CNNVD-202206-2252", "CNNVD-202207-1675", "CNNVD-202209-2343", "CNNVD-202210-1597", "CNNVD-202210-2429"}
	// MySQL
	// var codes []string = []string{"CNNVD-202101-1440", "CNNVD-202101-1438", "CNNVD-202101-1332", "CNNVD-202101-1350", "CNNVD-202101-1342", "CNNVD-202101-1458", "CNNVD-202101-1399", "CNNVD-202101-1431", "CNNVD-202101-1348", "CNNVD-202101-1331", "CNNVD-202101-1328", "CNNVD-202101-1337", "CNNVD-202101-1358", "CNNVD-202101-1423", "CNNVD-202104-1456", "CNNVD-202104-1442", "CNNVD-202104-1366", "CNNVD-202104-1447", "CNNVD-202104-1502", "CNNVD-202104-1460", "CNNVD-202104-1395", "CNNVD-202104-1486", "CNNVD-202104-1496", "CNNVD-202104-1504", "CNNVD-202104-1459", "CNNVD-202104-1433", "CNNVD-202104-1407", "CNNVD-202104-1519", "CNNVD-202104-1509", "CNNVD-202104-1443", "CNNVD-202104-1533", "CNNVD-202107-1469", "CNNVD-202107-1470", "CNNVD-202107-1495", "CNNVD-202110-1294", "CNNVD-202110-1336", "CNNVD-202110-1306", "CNNVD-202110-1300", "CNNVD-202110-1305", "CNNVD-202110-1304", "CNNVD-202110-1299", "CNNVD-202110-1295", "CNNVD-202110-1338", "CNNVD-202110-1301", "CNNVD-202110-1298", "CNNVD-202110-1351", "CNNVD-202201-1465", "CNNVD-202201-1453", "CNNVD-202201-1474", "CNNVD-202201-1476", "CNNVD-202201-1460", "CNNVD-202201-1462", "CNNVD-202201-1470", "CNNVD-202201-1464", "CNNVD-202201-1429", "CNNVD-202201-1456", "CNNVD-202201-1450", "CNNVD-202201-1480", "CNNVD-202201-1452", "CNNVD-202201-1472", "CNNVD-202201-1473", "CNNVD-202201-1479", "CNNVD-202201-1469", "CNNVD-202201-1615", "CNNVD-202201-1624", "CNNVD-202201-1597", "CNNVD-202201-1595", "CNNVD-202201-1611", "CNNVD-202201-1627", "CNNVD-202201-1621", "CNNVD-202201-1592", "CNNVD-202201-1602", "CNNVD-202201-1608", "CNNVD-202201-1622", "CNNVD-202201-1609", "CNNVD-202201-1620", "CNNVD-202201-1590", "CNNVD-202201-1593", "CNNVD-202201-1589", "CNNVD-202201-1614", "CNNVD-202201-1610", "CNNVD-202201-1617", "CNNVD-202201-1598", "CNNVD-202204-3833", "CNNVD-202204-3775", "CNNVD-202204-3766", "CNNVD-202204-3817", "CNNVD-202204-3771", "CNNVD-202204-3757", "CNNVD-202204-3814", "CNNVD-202204-3770", "CNNVD-202204-3760", "CNNVD-202204-3809", "CNNVD-202204-3808", "CNNVD-202204-3812", "CNNVD-202204-3765", "CNNVD-202204-3759", "CNNVD-202204-3752", "CNNVD-202207-1694", "CNNVD-202207-1709", "CNNVD-202207-1676", "CNNVD-202207-1705", "CNNVD-202207-1651", "CNNVD-202207-1690", "CNNVD-202207-1684", "CNNVD-202207-1697", "CNNVD-202207-1693", "CNNVD-202207-1683", "CNNVD-202207-1706", "CNNVD-202207-1631", "CNNVD-202210-1255", "CNNVD-202210-1316", "CNNVD-202210-1292", "CNNVD-202210-1257", "CNNVD-202210-1294", "CNNVD-202210-1284", "CNNVD-202210-1250", "CNNVD-202210-1310", "CNNVD-202210-1233", "CNNVD-202210-1315", "CNNVD-202210-1242", "CNNVD-202210-1304", "CNNVD-202210-1235"}
	// macOS
	// var codes []string = []string{"CNNVD-202201-2412", "CNNVD-202201-2408", "CNNVD-202203-1258", "CNNVD-202203-1301", "CNNVD-202203-1250", "CNNVD-202203-1273", "CNNVD-202203-1243", "CNNVD-202203-1248", "CNNVD-202203-1252", "CNNVD-202203-1320", "CNNVD-202203-1241", "CNNVD-202203-2677", "CNNVD-202205-3392", "CNNVD-202205-3413", "CNNVD-202205-3430", "CNNVD-202205-3441", "CNNVD-202205-3425", "CNNVD-202205-3398", "CNNVD-202205-3437", "CNNVD-202205-3412", "CNNVD-202205-3432", "CNNVD-202205-3397", "CNNVD-202205-3419", "CNNVD-202205-3410", "CNNVD-202205-3394", "CNNVD-202205-3395", "CNNVD-202205-3389", "CNNVD-202205-3385", "CNNVD-202205-3387", "CNNVD-202205-3390", "CNNVD-202205-4220", "CNNVD-202205-4221", "CNNVD-202207-2007", "CNNVD-202207-2033", "CNNVD-202207-2043", "CNNVD-202207-2041", "CNNVD-202207-2011", "CNNVD-202207-2026", "CNNVD-202207-2040", "CNNVD-202207-2029", "CNNVD-202207-2032", "CNNVD-202207-2013", "CNNVD-202207-2005", "CNNVD-202208-3348", "CNNVD-202209-776", "CNNVD-202209-766", "CNNVD-202209-778", "CNNVD-202209-785", "CNNVD-202209-781", "CNNVD-202209-773", "CNNVD-202209-780", "CNNVD-202209-1609", "CNNVD-202209-1599", "CNNVD-202209-2448", "CNNVD-202209-2460", "CNNVD-202210-1642", "CNNVD-202210-1634", "CNNVD-202210-1630", "CNNVD-202210-1616", "CNNVD-202210-1645", "CNNVD-202210-1633", "CNNVD-202210-1619", "CNNVD-202210-1661", "CNNVD-202210-1632", "CNNVD-202210-1622", "CNNVD-202210-1628", "CNNVD-202210-1625", "CNNVD-202210-1639", "CNNVD-202210-1644", "CNNVD-202210-1623", "CNNVD-202210-1631", "CNNVD-202210-1617", "CNNVD-202210-1621", "CNNVD-202210-1638", "CNNVD-202210-1615", "CNNVD-202210-2515", "CNNVD-202212-3343", "CNNVD-202212-3336", "CNNVD-202210-1634", "CNNVD-202203-1320", "CNNVD-202302-2151", "CNNVD-202209-776", "CNNVD-202302-2144", "CNNVD-202301-1762", "CNNVD-202302-2184", "CNNVD-202302-2129", "CNNVD-202209-1604", "CNNVD-202304-664", "CNNVD-202305-524", "CNNVD-202210-1674", "CNNVD-202209-785", "CNNVD-202210-1618", "CNNVD-201810-1459", "CNNVD-201810-1458", "CNNVD-201709-049", "CNNVD-202306-1765", "CNNVD-202209-195", "CNNVD-202302-1000", "CNNVD-202305-1832", "CNNVD-202305-1822", "CNNVD-202305-1828", "CNNVD-202305-478", "CNNVD-202305-1857", "CNNVD-202303-2263", "CNNVD-202301-1760", "CNNVD-202305-480", "CNNVD-202305-1835", "CNNVD-202301-1763", "CNNVD-202305-1849", "CNNVD-202303-2239", "CNNVD-202305-1851", "CNNVD-202303-2252", "CNNVD-202303-2406", "CNNVD-202303-2264", "CNNVD-202305-1819", "CNNVD-202303-2255", "CNNVD-202301-1766", "CNNVD-202305-1867", "CNNVD-202302-2131", "CNNVD-202303-2268", "CNNVD-202303-2270", "CNNVD-202303-2274", "CNNVD-202301-1768", "CNNVD-202305-1868", "CNNVD-202305-1838", "CNNVD-202305-1837", "CNNVD-202305-1831", "CNNVD-202304-573", "CNNVD-202306-1760", "CNNVD-202306-1761", "CNNVD-202303-2261", "CNNVD-202307-1932", "CNNVD-202307-1933", "CNNVD-202307-1919", "CNNVD-202307-1930", "CNNVD-202307-1944", "CNNVD-202307-1898", "CNNVD-202307-1913", "CNNVD-202307-1945", "CNNVD-202307-1918", "CNNVD-202307-2206", "CNNVD-202307-1895", "CNNVD-202307-1929", "CNNVD-202307-2208", "CNNVD-202307-2200", "CNNVD-202307-1907", "CNNVD-202307-1926", "CNNVD-202307-1909", "CNNVD-202307-1910", "CNNVD-202203-1239", "CNNVD-202203-1301", "CNNVD-202210-1613", "CNNVD-202205-3432", "CNNVD-202209-782", "CNNVD-202205-3396", "CNNVD-202205-4221", "CNNVD-202210-1614", "CNNVD-202207-2013", "CNNVD-202209-2460", "CNNVD-202205-4149", "CNNVD-202308-1286", "CNNVD-202308-1292", "CNNVD-202308-1296", "CNNVD-202308-1301", "CNNVD-202308-1289", "CNNVD-202308-1291", "CNNVD-202305-1841", "CNNVD-202305-1824", "CNNVD-202303-2271", "CNNVD-202309-476", "CNNVD-202309-462", "CNNVD-202309-459", "CNNVD-202309-480", "CNNVD-202309-472", "CNNVD-202309-471", "CNNVD-202309-479", "CNNVD-202309-461", "CNNVD-202309-465", "CNNVD-202309-463", "CNNVD-202309-473", "CNNVD-202309-562", "CNNVD-202309-568", "CNNVD-202309-604", "CNNVD-202309-468", "CNNVD-202305-1826", "CNNVD-202309-2248"}
	// windows
	// var codes []string = []string{"CNNVD-202201-843", "CNNVD-202201-831", "CNNVD-202201-804", "CNNVD-202201-773", "CNNVD-202201-788", "CNNVD-202201-763", "CNNVD-202201-759", "CNNVD-202201-790", "CNNVD-202201-837", "CNNVD-202201-798", "CNNVD-202201-811", "CNNVD-202201-830", "CNNVD-202202-595", "CNNVD-202202-615", "CNNVD-202202-622", "CNNVD-202203-669", "CNNVD-202203-672", "CNNVD-202203-684", "CNNVD-202203-677", "CNNVD-202204-3062", "CNNVD-202204-3018", "CNNVD-202204-2949", "CNNVD-202204-3189", "CNNVD-202204-3044", "CNNVD-202204-3100", "CNNVD-202204-3053", "CNNVD-202204-3114", "CNNVD-202204-3029", "CNNVD-202204-3030", "CNNVD-202204-3099", "CNNVD-202205-2767", "CNNVD-202205-2876", "CNNVD-202205-2870", "CNNVD-202205-2764", "CNNVD-202205-2743", "CNNVD-202205-2794", "CNNVD-202205-2754", "CNNVD-202205-2782", "CNNVD-202206-1347", "CNNVD-202206-1290", "CNNVD-202206-1465", "CNNVD-202206-1330", "CNNVD-202206-1341", "CNNVD-202206-1221", "CNNVD-202207-1032", "CNNVD-202207-896", "CNNVD-202207-1021", "CNNVD-202207-1030", "CNNVD-202207-888", "CNNVD-202207-873", "CNNVD-202208-2512", "CNNVD-202208-2520", "CNNVD-202208-2511", "CNNVD-202208-2544", "CNNVD-202208-2562", "CNNVD-202208-2615", "CNNVD-202208-2535", "CNNVD-202208-2593", "CNNVD-202208-2555", "CNNVD-202208-2576", "CNNVD-202209-828", "CNNVD-202209-927", "CNNVD-202209-812", "CNNVD-202209-823", "CNNVD-202209-913", "CNNVD-202209-836", "CNNVD-202210-562", "CNNVD-202210-555", "CNNVD-202210-550", "CNNVD-202210-426", "CNNVD-202210-419", "CNNVD-202210-470", "CNNVD-202210-443", "CNNVD-202210-490", "CNNVD-202210-487", "CNNVD-202211-2264", "CNNVD-202211-2265", "CNNVD-202211-2300", "CNNVD-202211-2283", "CNNVD-202211-2240", "CNNVD-202211-2246", "CNNVD-202212-2980", "CNNVD-202212-2975", "CNNVD-202212-3009", "CNNVD-202212-2992", "CNNVD-202302-1131", "CNNVD-202302-1092", "CNNVD-202302-1133", "CNNVD-202302-1089", "CNNVD-201911-574", "CNNVD-202211-2265", "CNNVD-202211-2248", "CNNVD-202211-2275", "CNNVD-202211-2282", "CNNVD-202211-2290", "CNNVD-202211-2254", "CNNVD-202303-1071", "CNNVD-202303-1026", "CNNVD-202303-1070", "CNNVD-202303-1015", "CNNVD-201706-509", "CNNVD-202209-915", "CNNVD-202209-927", "CNNVD-202209-834", "CNNVD-202209-922", "CNNVD-202209-821", "CNNVD-202304-881", "CNNVD-202304-844", "CNNVD-202304-872", "CNNVD-202304-822", "CNNVD-202304-860", "CNNVD-202304-886", "CNNVD-202304-827", "CNNVD-202304-831", "CNNVD-202304-797", "CNNVD-202304-818", "CNNVD-202301-750", "CNNVD-202301-777", "CNNVD-202301-737", "CNNVD-202301-726", "CNNVD-202301-763", "CNNVD-202301-715", "CNNVD-202301-812", "CNNVD-202301-748", "CNNVD-202301-756", "CNNVD-202304-874", "CNNVD-202305-768", "CNNVD-202305-741", "CNNVD-202305-747", "CNNVD-202305-733", "CNNVD-202207-877", "CNNVD-202207-1093", "CNNVD-202207-889", "CNNVD-202208-2556", "CNNVD-202208-2519", "CNNVD-202208-2575", "CNNVD-202208-2562", "CNNVD-202208-2557", "CNNVD-202208-2552", "CNNVD-202208-2523", "CNNVD-202208-2531", "CNNVD-202208-2521", "CNNVD-202208-2536", "CNNVD-202306-970", "CNNVD-202306-986", "CNNVD-202306-959", "CNNVD-202306-991", "CNNVD-202306-907", "CNNVD-202204-3088", "CNNVD-202202-617", "CNNVD-202203-669", "CNNVD-202204-3201", "CNNVD-202204-3128", "CNNVD-202203-697", "CNNVD-202204-3121", "CNNVD-202204-3192", "CNNVD-202203-684", "CNNVD-202204-3073", "CNNVD-202201-779", "CNNVD-202307-929", "CNNVD-202307-932", "CNNVD-202307-879", "CNNVD-202307-841", "CNNVD-202307-857", "CNNVD-202307-842", "CNNVD-202307-885", "CNNVD-202307-859", "CNNVD-202307-923", "CNNVD-202307-817", "CNNVD-202307-836", "CNNVD-202307-837", "CNNVD-202307-833", "CNNVD-202110-821", "CNNVD-202110-820", "CNNVD-202110-869", "CNNVD-202110-805", "CNNVD-202110-815", "CNNVD-202105-583", "CNNVD-202105-570", "CNNVD-202111-797", "CNNVD-202207-910", "CNNVD-202109-881", "CNNVD-202204-3052", "CNNVD-202201-805", "CNNVD-202210-566", "CNNVD-202202-595", "CNNVD-202207-893", "CNNVD-202206-1234", "CNNVD-202201-823", "CNNVD-202209-827", "CNNVD-202201-832", "CNNVD-202204-3105", "CNNVD-202211-2268", "CNNVD-202207-898", "CNNVD-202111-802", "CNNVD-202203-667", "CNNVD-202205-2780", "CNNVD-202211-2241", "CNNVD-202204-3067", "CNNVD-202204-3029", "CNNVD-202207-875", "CNNVD-202203-680", "CNNVD-202202-625", "CNNVD-202108-867", "CNNVD-202205-2782", "CNNVD-202201-824", "CNNVD-202308-743", "CNNVD-202308-721", "CNNVD-202308-718", "CNNVD-202308-722", "CNNVD-202305-767", "CNNVD-202309-890", "CNNVD-202309-841", "CNNVD-202211-2288", "CNNVD-202211-2274"}
	// Ubuntu
	// var codes []string = []string{"CNNVD-202101-276", "CNNVD-202101-947", "CNNVD-202101-1130", "CNNVD-202101-1465", "CNNVD-202101-2603", "CNNVD-202102-650", "CNNVD-202102-1194", "CNNVD-202102-1248", "CNNVD-202102-1218", "CNNVD-202102-1424", "CNNVD-202103-522", "CNNVD-202103-474", "CNNVD-202103-523", "CNNVD-202103-778", "CNNVD-202103-961", "CNNVD-202103-1071", "CNNVD-202103-1196", "CNNVD-202103-1223", "CNNVD-202103-1226", "CNNVD-202103-1265", "CNNVD-202103-1351", "CNNVD-202103-1576", "CNNVD-202103-1574", "CNNVD-202103-1694", "CNNVD-202103-1648", "CNNVD-202103-1721", "CNNVD-202104-357", "CNNVD-202104-355", "CNNVD-202104-358", "CNNVD-202104-417", "CNNVD-202104-1118", "CNNVD-202104-1357", "CNNVD-202104-1355", "CNNVD-202105-063", "CNNVD-202105-287", "CNNVD-202105-714", "CNNVD-202105-723", "CNNVD-202105-633", "CNNVD-202105-722", "CNNVD-202105-632", "CNNVD-202105-865", "CNNVD-202105-862", "CNNVD-202105-1772", "CNNVD-202106-414", "CNNVD-202106-416", "CNNVD-202106-478", "CNNVD-202106-1390", "CNNVD-202106-1443", "CNNVD-202106-1601", "CNNVD-202107-280", "CNNVD-202107-1534", "CNNVD-202107-1701", "CNNVD-202108-003", "CNNVD-202108-542", "CNNVD-202108-703", "CNNVD-202108-763", "CNNVD-202108-764", "CNNVD-202108-762", "CNNVD-202108-775", "CNNVD-202108-769", "CNNVD-202108-770", "CNNVD-202108-2376", "CNNVD-202109-086", "CNNVD-202109-305", "CNNVD-202109-996", "CNNVD-202109-1095", "CNNVD-202109-1092", "CNNVD-202109-1659", "CNNVD-202110-072", "CNNVD-202110-785", "CNNVD-202110-1485", "CNNVD-202110-2211", "CNNVD-202110-2027", "CNNVD-202111-349", "CNNVD-202111-426", "CNNVD-202111-1544", "CNNVD-202111-2081", "CNNVD-202111-2397", "CNNVD-202112-533", "CNNVD-202112-1388", "CNNVD-202112-1930", "CNNVD-202112-2166", "CNNVD-202112-2259", "CNNVD-202201-468", "CNNVD-202201-897", "CNNVD-202201-1165", "CNNVD-202201-1423", "CNNVD-202201-2156", "CNNVD-202201-2341", "CNNVD-202201-2342", "CNNVD-202201-2590", "CNNVD-202201-2702", "CNNVD-202201-2844", "CNNVD-202202-369", "CNNVD-202202-438", "CNNVD-202202-441", "CNNVD-202202-927", "CNNVD-202202-1026", "CNNVD-202202-1027", "CNNVD-202202-1368", "CNNVD-202202-1349", "CNNVD-202202-1672", "CNNVD-202202-1741", "CNNVD-202203-508", "CNNVD-202203-939", "CNNVD-202203-941", "CNNVD-202203-1504", "CNNVD-202203-1821", "CNNVD-202203-2077", "CNNVD-202203-2079", "CNNVD-202203-2068", "CNNVD-202203-2249", "CNNVD-202203-2386", "CNNVD-202203-2463", "CNNVD-202203-2599", "CNNVD-202204-1851", "CNNVD-202204-1856", "CNNVD-202204-1870", "CNNVD-202204-2474", "CNNVD-202204-2631", "CNNVD-202204-2924", "CNNVD-202204-3034", "CNNVD-202204-3299", "CNNVD-202204-3433", "CNNVD-202204-3707", "CNNVD-202204-4273", "CNNVD-202205-1850", "CNNVD-202205-1925", "CNNVD-202205-3039", "CNNVD-202205-3043", "CNNVD-202205-3523", "CNNVD-202205-3587", "CNNVD-202205-3948", "CNNVD-202205-4110", "CNNVD-202205-4090", "CNNVD-202205-4251", "CNNVD-202206-307", "CNNVD-202206-309", "CNNVD-202206-579", "CNNVD-202206-874", "CNNVD-202206-873", "CNNVD-202206-899", "CNNVD-202206-1312", "CNNVD-202206-2152", "CNNVD-202206-2546", "CNNVD-202207-366", "CNNVD-202207-499", "CNNVD-202207-1241", "CNNVD-202207-1509", "CNNVD-202207-2145", "CNNVD-202207-2277", "CNNVD-202207-2526", "CNNVD-202207-2761", "CNNVD-202208-2050", "CNNVD-202208-2507", "CNNVD-202208-2506", "CNNVD-202208-3643", "CNNVD-202208-3808", "CNNVD-202208-3769", "CNNVD-202208-3826", "CNNVD-202208-4224", "CNNVD-202208-4254", "CNNVD-202208-4314", "CNNVD-202208-4315", "CNNVD-202208-4476", "CNNVD-202209-030", "CNNVD-202209-099", "CNNVD-202209-096", "CNNVD-202209-666", "CNNVD-202209-588", "CNNVD-202209-562", "CNNVD-202209-1027", "CNNVD-202209-1050", "CNNVD-202209-1254", "CNNVD-202209-1522", "CNNVD-202209-1690", "CNNVD-202209-2750", "CNNVD-202209-3128", "CNNVD-202209-3133", "CNNVD-202210-354", "CNNVD-202210-794", "CNNVD-202210-845", "CNNVD-202210-1050", "CNNVD-202210-1043", "CNNVD-202210-1106", "CNNVD-202210-1141", "CNNVD-202210-1146", "CNNVD-202210-1052", "CNNVD-202210-1053", "CNNVD-202210-1081", "CNNVD-202210-1282", "CNNVD-202210-1333", "CNNVD-202210-1508", "CNNVD-202210-1522", "CNNVD-202210-1530", "CNNVD-202210-1600", "CNNVD-202210-1563", "CNNVD-202210-1542", "CNNVD-202210-1546", "CNNVD-202210-1553", "CNNVD-202210-1701", "CNNVD-202210-2506", "CNNVD-202210-2510", "CNNVD-202210-2596", "CNNVD-202211-2565", "CNNVD-202211-2732", "CNNVD-202211-3466", "CNNVD-202211-3469", "CNNVD-202211-3470", "CNNVD-202211-3474", "CNNVD-202211-3534", "CNNVD-202211-3583", "CNNVD-202211-3692", "CNNVD-202212-2435", "CNNVD-202212-3181", "CNNVD-202212-3169", "CNNVD-202212-3165", "CNNVD-202212-3174", "CNNVD-202212-3171", "CNNVD-202212-3164", "CNNVD-202212-3264", "CNNVD-202212-3453", "CNNVD-202212-3481", "CNNVD-202212-3482", "CNNVD-202212-3799", "CNNVD-202212-3754", "CNNVD-202212-3798", "CNNVD-202212-3846"}
	currentTime := time.Now()
	var fileName = currentTime.Format("2006-01-02 15-04-05") + ".csv"
	file, err := os.OpenFile(fileName, os.O_RDWR|os.O_CREATE|os.O_TRUNC, 0666)
	if err != nil {
		log.Fatal().Msgf("file open error:%v", err)
	}
	var index = 0
	for _, code := range codes {
		index += 1
		reqAllVuln(code, file, index)
	}
	defer file.Close()
	return nil
}

func reqAllVuln(code string, file *os.File, index int) {
	c := cnnvd.ReqVulList{
		PageIndex:   PageIndex,
		PageSize:    PageSize,
		Keyword:     code,
		HazardLevel: level[HazardLevel],
		Vendor:      Vendor,
		Product:     Product,
		VulName:     VulName,
	}
	vulns, err := c.Fetch(Retry)
	if err != nil {
		log.Fatal().Interface("request", c).Int("retry", Retry).
			Msgf("failed to search vulns:%v", err)
	}
	log.Info().Interface("request", c).Int("retry", Retry).
		Msg("success to request... ...")
	if len(vulns) == 0 {
		log.Info().Interface("request", c).Int("retry", Retry).
			Msg("there is no record")
		return
	}
	bar := pb.StartNew(len(vulns))
	var customData [][]string

	for _, vuln := range vulns {
		if vuln.CnnvdCode != code {
			continue
		}
		detailC := cnnvd.ReqVulDetail{Id: vuln.Id, VulType: vuln.VulType, CnnvdCode: vuln.CnnvdCode}
		detail, err := detailC.Fetch(Retry)
		log.Debug().Interface("request", detailC).Int("retry", Retry).
			Msg("success to request... ...")
		if err != nil {
			log.Fatal().Interface("request", detailC).Int("retry", Retry).
				Msgf("failed to search vuln detail:%v", err)
		}
		customData = append(customData, []string{detail.VulName, detail.CnnvdCode, detail.CveCode,
			detail.VulDesc, "已修复：" + detail.Patch, severity[detail.HazardLevel], "", detail.VulType})
		// fmt.Println(detail)
		var score = 0.0
		if detail.HazardLevel == 1 {
			score = 9.1
		} else if detail.HazardLevel == 2 {
			score = 7.5
		} else if detail.HazardLevel == 3 {
			score = 5.3
		} else if detail.HazardLevel == 4 {
			score = 3.2
		}
		var desc = strings.ReplaceAll(detail.VulDesc, "\r", "")
		desc = strings.ReplaceAll(desc, "\n", "")
		desc = strings.ReplaceAll(desc, ",", "，")
		var patch = "未修复"
		if detail.Patch != "" {
			patch = "已修复：" + detail.Patch
		} else {
			continue
		}
		data := fmt.Sprint(index) + ". " + "漏洞名称," + detail.VulName + ",厂商," + detail.AffectedVendor + "\n" +
			"CNNVD编号," + detail.CnnvdCode + ",危害等级," + severity[detail.HazardLevel] + "\n" +
			"CVE编号," + detail.CveCode + ",漏洞评分," + fmt.Sprint(score) + "\n" +
			"漏洞简介," + desc + ",漏洞类型," + detail.VulType + "\n" +
			"修复情况," + patch + "\n"
		dataN, _ := simplifiedchinese.GBK.NewEncoder().String(data)
		count, err := file.WriteString(dataN)
		if err != nil || count == 0 {
			log.Fatal().Msgf("file wirte error:%v", err)
		}
		bar.Increment()
	}
	bar.Finish()
	var indexJ = 0
	for _, row := range customData {
		fmt.Println("---------------" + fmt.Sprint(indexJ) + "---------------")
		for _, cell := range row {
			fmt.Println(cell)
		}
		indexJ += 1
	}
}
